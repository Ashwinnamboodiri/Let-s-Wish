var wish=require("../models/wisher");module.exports=function(a){a.post("/wisher",function(c,b){var d=new wish();
d.messages=c.body.messages;d.choice=c.body.choice;d.counter=c.body.counter;d.views=c.body.views;d.fest=c.body.fest;d.uname=c.body.uname;if(c.body.messages===null||c.body.messages===""||c.body.views===null||c.body.views===0||c.body.choice===null||c.body.choice===""||c.body.counter===0||c.body.counter===null||c.body.fest===""||c.body.fest===null||c.body.uname===""||c.body.uname===null){b.json({success:false,message:"Ensure all the details were provided"})}else{d.save(function(e){if(e){b.json({success:false,message:e})}else{b.json({success:true,messages:d.messages,views:d.views,choice:d.choice,fest:d.fest,counter:d.counter,uname:d.uname})}})}});
a.put("/inc_views",function(c,b){wish.findOne({counter:c.body.counter}).select("counter views ").exec(function(d,e){if(d){b.json({success:false,message:d})}else{if(c.body.counter===""||c.body.counter===null){b.json({success:false,message:"Counter Id was not provided"})}else{e.views=c.body.views;e.save(function(f){if(f){b.json({success:false,message:f})}else{b.json({success:true,message:"No of views updated"})}})}}})});a.post("/message",function(c,b){wish.findOne({counter:c.body.counter}).select("counter views fest uname messages").exec(function(d,e){if(d){b.json({success:false,message:d})}else{if(!e){b.json({success:false})}else{e.views=parseInt(e.views,10)+1;e.save();b.json({success:true,messages:e.messages,uname:e.uname,views:e.views,fest:e.fest,counter:e.counter})}}})});return a};